<div id="bars-carousel" class="carousel slide" data-ride="carousel">

  <!-- Indicators -->
  <ol class="carousel-indicators" id="carousel-indicators">
    {{#each data}}
        <li data-target="#bars-carousel" data-slide-to="{{this.id}}"></li>
    {{/each}}
  </ol>

  <!-- Wrapper for slides -->
  <div class="carousel-inner" role="listbox" id="carousel-inner">
    {{#each data}}
      <div class="item">
        <img src="http://www.uppanorama.com/wp-content/uploads/2013/06/NorthernLightsHoughton.jpg">
        <div class="carousel-caption">
          <h2>{{this.name}}</h2>
          <h4>{{this.address}}, {{this.city}}, {{this.state}}</h4>
          <h6>{{this.nights}}</h6>
          {{#if this.avgRating}}
            <h5>Average user rating: <span class='rating-small'>{{{this.avgRatingHearts}}} </span></h5>
          {{else}}
            <h5>Bar not yet rated by any users</h5>
          {{/if}}

          {{#if this.yourRating}}
            <h5 class="logged-in-option" hidden>
              Your rating: <span class='rating-small'>{{{this.yourRatingHearts}}} </span> /
              <a href="#" data-toggle="modal" data-target="#add-favorites-modal-{{this.id}}">Add to Favorites</a>
            </h5>
          {{else}}
            <h5 class="logged-in-option" hidden>
              <a href="#" id="write-a-review" class="logged-in-option" data-toggle="modal" data-target="#write-review-modal-{{this.id}}">Write a Review</a> /
              <a href="#" data-toggle="modal" data-target="#add-favorites-modal-{{this.id}}" class="logged-in-option">Add to Favorites</a>
            </h5>
          {{/if}}
          <br>
          <br>
        </div>
      </div>
    {{/each}}
  </div>

  <!-- Controls -->
  <a class="left carousel-control" href="#bars-carousel" role="button" data-slide="prev">
    <span class="glyphicon glyphicon-chevron-left"></span>
  </a>
  <a class="right carousel-control" href="#bars-carousel" role="button" data-slide="next">
    <span class="glyphicon glyphicon-chevron-right"></span>
  </a>

</div>

{{#each data}}
<div class="modal fade write-review-modal" id="write-review-modal-{{this.id}}" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" id="myModalLabel">Leave a Review for {{this.name}}</h4>
      </div>
      <div class="modal-body">
        <form id="new-review-{{this.id}}" class="add-review">
          <div class="form-group">
            <textarea name="review[bar_id]" class="form-control">{{this.id}}</textarea>
          </div>
          <div class="form-group">
            <textarea name="review[comment]" class="form-control" id="review-comment" rows="3" placeholder="Write a comment."></textarea>
          </div>
          <div class="form-group">
            <select class="form-control" name=review[rating] data-show-icon="true">
              <option>1</option>
              <option>2</option>
              <option>3</option>
              <option>4</option>
              <option>5</option>
            </select>
          </div>
          <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
          <button type="submit" class="btn btn-primary submit-review" id="btn-submit">Submit</button>
        </form>
      </div>
    </div>
  </div>
</div>

<div class="modal fade add-favorites-modal" id="add-favorites-modal-{{this.id}}" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" class="add-favorites-modal">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" id="myModalLabel">Add {{this.name}} to favorites?</h4>
      </div>
      <div class="modal-body">
        <form id="add-favorite-{{this.id}}" class="add-favorite">
          <div class="form-group" hidden>
            <textarea name="favorite[bar_id]" class="form-control">{{this.id}}</textarea>
          </div>
          <button type="submit" class="btn btn-primary">Yes!</button>
          <button type="button" class="btn btn-default" data-dismiss="modal">Nevermind</button>
        </form>
      </div>
    </div>
  </div>
</div>
{{/each}}
